include::{partialsdir}/attributes.adoc[]

== Registering your Device in {unifiedpush-service}

To make use of the {unifiedpush-service} service devices need to be registered by calling an endpoint of the server.
The SDKs will handle this for you and the following steps will give you everything you need to start working with push notifications.

[role="primary"]
.Android

****

. Getting an instance of the PushService
+
[source,java]
----
PushService pushService = new PushService.Builder().openshift().build();
----

. Registration request
+
[source,java]
----
pushService.registerDevice()
  .requestOn(new AppExecutors().mainThread())
  .respondWith(new Responder<Boolean>() {
    @Override
    public void onResult(Boolean value) { // Yay }

    @Override
    public void onException(Exception exception) { // Oops! }
});
----

****

[role="secondary"]
.iOS

****

[source,swift]
----
func application(_ application: UIApplication,
                 didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data) {
    var config = UnifiedPushConfig()
    AgsPush.instance.register(
        deviceToken,
        config,
        success: {
           print("Successfully registered to Unified Push Server")
        },
        failure: { (error: Error!) in
           print("Failure to register for on Unified Push Server: \(error)")
        }
    )
}
----

****

[role="secondary"]
.Cordova

****

*Using plain Cordova*

[source,javascript]
----
const push = PushNotification.init({
    android: {},
    ios: {
        alert: "true",
        badge: "true",
        sound: "true"
    }
});

// Registration handler
push.on('registration', data => {
    // PushRegistration is part of @aerogear/push
    new PushRegistration().register(data.registrationId).then(() => {
        // Registration with UPS successful, you can now send push notifications from the UPS UI
    }).catch(err => {
        // Error on device registration
    });
});
----

*Using Ionic*

[source,javascript]
----
import { Push } from "@ionic-native/push";

const pushObject = new Push().init({
    android: {},
    ios: {
        alert: true,
        badge: true,
        sound: true
    }
});

pushObject.on('registration').subscribe(data => {
    new PushRegistration().register(data.registrationId).then(() => {
        // Registration with UPS successful, you can now send push notifications from the UPS UI
    }).catch(err => {
        //Error on device registration
    });
});
----

****